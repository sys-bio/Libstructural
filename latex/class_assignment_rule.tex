\hypertarget{class_assignment_rule}{}\section{Assignment\+Rule Class Reference}
\label{class_assignment_rule}\index{Assignment\+Rule@{Assignment\+Rule}}


{\ttfamily \#include $<$Assignment\+Rule.\+h$>$}



\subsection{Detailed Description}
\{core\} An S\+B\+ML {\itshape assignment rule} representing {\itshape x = f({\bfseries Y})}.

The rule type \hyperlink{class_assignment_rule}{Assignment\+Rule} is derived from the parent class \hyperlink{class_rule}{Rule}. It is used to express equations that set the values of variables. The left-\/hand side (the attribute named \char`\"{}variable\char`\"{}) of an assignment rule must refer to the identifier of a \hyperlink{class_species}{Species}, \hyperlink{class_species_reference}{Species\+Reference} (in S\+B\+ML Level~3), \hyperlink{class_compartment}{Compartment}, or global \hyperlink{class_parameter}{Parameter} object in the model (but not a \hyperlink{class_reaction}{Reaction}). In S\+B\+ML Level~3 Version~2, it may also refer to the S\+Id of an element defined in an S\+B\+ML Level~3 package with mathematical meaning and the ability to be assigned. The entity identified must have its \char`\"{}constant\char`\"{} attribute set to {\ttfamily false}. The effects of an assignment rule construct are in general terms the same, but differ in the precise details depending on the type of S\+B\+ML component being set\+: 
\begin{DoxyItemize}
\item {\itshape In the case of a species}, an S\+B\+ML assignment rule sets the referenced species\textquotesingle{} quantity (whether a \char`\"{}concentration\char`\"{} or \char`\"{}amount\char`\"{}) to the value determined by the formula in the Math\+ML subelement \char`\"{}math\char`\"{}. The unit associated with the value produced by the \char`\"{}math\char`\"{} formula {\itshape should} (in S\+B\+ML Level~2 Version~4 and in S\+B\+ML Level~3) or {\itshape must} (in S\+B\+ML releases prior to Level~2 version~4) be equal to the unit associated with the species\textquotesingle{} quantity. {\itshape Restrictions}\+: There must not be both an \hyperlink{class_assignment_rule}{Assignment\+Rule} \char`\"{}variable\char`\"{} attribute and a \hyperlink{class_species_reference}{Species\+Reference} \char`\"{}species\char`\"{} attribute having the same value in a model, unless the referenced \hyperlink{class_species}{Species} object has its \char`\"{}boundary\+Condition\char`\"{} attribute set to {\ttfamily true}. In other words, an assignment rule cannot be defined for a species that is created or destroyed in a reaction unless that species is defined as a boundary condition in the model.


\item (For S\+B\+ML Level~3 only) {\itshape In the case of a species reference}, an assignment rule sets the stoichiometry of the referenced reactant or product to the value determined by the formula in \char`\"{}math\char`\"{}. The unit associated with the value produced by the \char`\"{}math\char`\"{} formula should be consistent with the unit \char`\"{}dimensionless\char`\"{}, because reactant and product stoichiometries in reactions are dimensionless quantities.


\item {\itshape In the case of a compartment}, an S\+B\+ML assignment rule sets the referenced compartment\textquotesingle{}s size to the value determined by the formula in the \char`\"{}math\char`\"{} subelement of the \hyperlink{class_assignment_rule}{Assignment\+Rule} object. The overall units of the formula in \char`\"{}math\char`\"{} {\itshape should} (in S\+B\+ML Level~2 Version~4 and in S\+B\+ML Level~3) or {\itshape must} (in S\+B\+ML releases prior to Level~2 version~4) be the same as the units of the size of the compartment.


\item {\itshape In the case of a parameter}, an assignment rule sets the referenced parameter\textquotesingle{}s value to that determined by the formula in the \char`\"{}math\char`\"{} subelement of the \hyperlink{class_assignment_rule}{Assignment\+Rule} object. The overall units of the formula in the \char`\"{}math\char`\"{} subelement {\itshape should} (in S\+B\+ML Level~2 Version~4 and in S\+B\+ML Level~3) or {\itshape must} (in S\+B\+ML releases prior to Level~2 version~4) be the same as the units defined for the parameter.


\item (For S\+B\+ML Level~3 Version~2 only) {\itshape In the case of an object from an S\+B\+ML Level~3 package}, an \hyperlink{class_assignment_rule}{Assignment\+Rule} sets the referenced object\textquotesingle{}s value (as defined by that package) to the value of the formula in math. The unit of measurement associated with the value produced by the formula should be the same as that object\textquotesingle{}s units attribute value (if it has such an attribute), or be equal to the units of model components of that type (if objects of that class are defined by the package as having the same units).


\end{DoxyItemize}

In S\+B\+ML Level~2 and Level~3 Version~1, the \char`\"{}math\char`\"{} subelement of the \hyperlink{class_assignment_rule}{Assignment\+Rule} is required. In S\+B\+ML Level~3 Version~2, this rule is relaxed, and the subelement is optional. If an \hyperlink{class_assignment_rule}{Assignment\+Rule} with no \char`\"{}math\char`\"{} child is present in the model, the value of its referenced \char`\"{}variable\char`\"{} is undefined. This may represent a situation where the model itself is unfinished, or the missing information may be provided by an S\+B\+ML Level~3 package.

If the variable attribute of an \hyperlink{class_assignment_rule}{Assignment\+Rule} object references an object in an S\+B\+ML namespace not understood by the interpreter reading a given S\+B\+ML document (that is, if the object is defined by an S\+B\+ML Level~3 package that the software does not support), the assignment rule must be ignored--the object\textquotesingle{}s value will not need to be set, as the interpreter could not understand that package. If an interpreter cannot establish whether a referenced object is missing from the model or instead is defined in an S\+B\+ML namespace not understood by the interpreter, it may produce a warning to the user. (The latter situation may only arise if an S\+B\+ML package is present in the S\+B\+ML document with a package\+:required attribute of \char`\"{}true\char`\"{}.)

In the context of a simulation, assignment rules are in effect at all times, {\itshape t} $\geq$ {\itshape 0}. For purposes of evaluating expressions that involve the {\itshape delay} \char`\"{}csymbol\char`\"{} (see the S\+B\+ML Level~2 specification), assignment rules are considered to apply also at {\itshape t} $\leq$ {\itshape 0}. Please consult the relevant S\+B\+ML specification for additional information about the semantics of assignments, rules, and entity values for simulation time {\itshape t} $\leq$ {\itshape 0}.

A model must not contain more than one \hyperlink{class_assignment_rule}{Assignment\+Rule} or \hyperlink{class_rate_rule}{Rate\+Rule} object having the same value of \char`\"{}variable\char`\"{}; in other words, in the set of all assignment rules and rate rules in an S\+B\+ML model, each variable appearing in the left-\/hand sides can only appear once. This simply follows from the fact that an indeterminate system would result if a model contained more than one assignment rule for the same variable or both an assignment rule and a rate rule for the same variable.

Similarly, a model must also not contain {\itshape both} an \hyperlink{class_assignment_rule}{Assignment\+Rule} and an \hyperlink{class_initial_assignment}{Initial\+Assignment} definition for the same variable, because both kinds of constructs apply prior to and at the start of simulation time, i.\+e., {\itshape t} $\leq$ {\itshape 0}. If a model contained both an initial assignment and an assignment rule for the same variable, an indeterminate system would result.

The value calculated by an \hyperlink{class_assignment_rule}{Assignment\+Rule} object overrides the value assigned to the given symbol by the model component defining that symbol. For example, if a \hyperlink{class_compartment}{Compartment} object\textquotesingle{}s \char`\"{}size\char`\"{} attribute value is set in its definition, and the model also contains an \hyperlink{class_assignment_rule}{Assignment\+Rule} object having that compartment\textquotesingle{}s \char`\"{}id\char`\"{} as its \char`\"{}variable\char`\"{} value, then the \char`\"{}size\char`\"{} assigned in the \hyperlink{class_compartment}{Compartment} object definition is ignored and the value assigned based on the computation defined in the \hyperlink{class_assignment_rule}{Assignment\+Rule}. This does {\itshape not} mean that a definition for a given symbol can be omitted if there is an \hyperlink{class_assignment_rule}{Assignment\+Rule} object involving it. For example, there must be a \hyperlink{class_parameter}{Parameter} object definition for a given parameter if there is an \hyperlink{class_assignment_rule}{Assignment\+Rule} definition for that parameter. It is only a question of which value definition takes precedence.\hypertarget{classdoc__rules__general__summary_rules-general}{}\subsection{General summary of S\+B\+M\+L rules}\label{classdoc__rules__general__summary_rules-general}
In S\+B\+ML Level~3 as well as Level~2, rules are separated into three subclasses for the benefit of model analysis software. The three subclasses are based on the following three different possible functional forms (where {\itshape x} is a variable, {\itshape f} is some arbitrary function returning a numerical result, {\bfseries {\itshape V}} is a vector of variables that does not include {\itshape x}, and {\bfseries {\itshape W}} is a vector of variables that may include {\itshape x})\+:

\tabulinesep=1mm
\begin{longtabu} spread 0pt [c]{*{3}{|X[-1]}|}
\hline
{\itshape Algebraic\+:}&left-\/hand side is zero&{\itshape 0 = f({\bfseries W})} \\\cline{1-3}
{\itshape Assignment\+:}&left-\/hand side is a scalar\+:&{\itshape x = f({\bfseries V})} \\\cline{1-3}
{\itshape Rate\+:}&left-\/hand side is a rate-\/of-\/change\+:&{\itshape dx/dt = f({\bfseries W})} \\\cline{1-3}
\end{longtabu}


In their general form given above, there is little to distinguish between {\itshape assignment} and {\itshape algebraic} rules. They are treated as separate cases for the following reasons\+:

\begin{DoxyItemize}
\item {\itshape Assignment} rules can simply be evaluated to calculate intermediate values for use in numerical methods. They are statements of equality that hold at all times. (For assignments that are only performed once, see \hyperlink{class_initial_assignment}{Initial\+Assignment}.)\end{DoxyItemize}
\begin{DoxyItemize}
\item S\+B\+ML needs to place restrictions on assignment rules, for example the restriction that assignment rules cannot contain algebraic loops.\end{DoxyItemize}
\begin{DoxyItemize}
\item Some simulators do not contain numerical solvers capable of solving unconstrained algebraic equations, and providing more direct forms such as assignment rules may enable those simulators to process models they could not process if the same assignments were put in the form of general algebraic equations;\end{DoxyItemize}
\begin{DoxyItemize}
\item Those simulators that {\itshape can} solve these algebraic equations make a distinction between the different categories listed above; and\end{DoxyItemize}
\begin{DoxyItemize}
\item Some specialized numerical analyses of models may only be applicable to models that do not contain {\itshape algebraic} rules.\end{DoxyItemize}
The approach taken to covering these cases in S\+B\+ML is to define an abstract \hyperlink{class_rule}{Rule} structure containing a subelement, \char`\"{}math\char`\"{}, to hold the right-\/hand side expression, then to derive subtypes of \hyperlink{class_rule}{Rule} that add attributes to distinguish the cases of algebraic, assignment and rate rules. The \char`\"{}math\char`\"{} subelement must contain a Math\+ML expression defining the mathematical formula of the rule. This Math\+ML formula must return a numerical value. The formula can be an arbitrary expression referencing the variables and other entities in an S\+B\+ML model.

Each of the three subclasses of \hyperlink{class_rule}{Rule} (\hyperlink{class_assignment_rule}{Assignment\+Rule}, \hyperlink{class_algebraic_rule}{Algebraic\+Rule}, \hyperlink{class_rate_rule}{Rate\+Rule}) inherit the the \char`\"{}math\char`\"{} subelement and other fields from \hyperlink{class_s_base}{S\+Base}. The \hyperlink{class_assignment_rule}{Assignment\+Rule} and \hyperlink{class_rate_rule}{Rate\+Rule} classes add an additional attribute, \char`\"{}variable\char`\"{}. See the definitions of \hyperlink{class_assignment_rule}{Assignment\+Rule}, \hyperlink{class_algebraic_rule}{Algebraic\+Rule} and \hyperlink{class_rate_rule}{Rate\+Rule} for details about the structure and interpretation of each one.\hypertarget{classdoc__rules__general__summary_rules-restrictions}{}\subsection{Additional restrictions on S\+B\+M\+L rules}\label{classdoc__rules__general__summary_rules-restrictions}
An important design goal of S\+B\+ML rule semantics is to ensure that a model\textquotesingle{}s simulation and analysis results will not be dependent on when or how often rules are evaluated. To achieve this, S\+B\+ML needs to place two restrictions on rule use. The first concerns algebraic loops in the system of assignments in a model, and the second concerns overdetermined systems.\hypertarget{classdoc__rules__general__summary_rules-no-loops}{}\subsubsection{A model must not contain algebraic loops}\label{classdoc__rules__general__summary_rules-no-loops}
The combined set of \hyperlink{class_initial_assignment}{Initial\+Assignment}, \hyperlink{class_assignment_rule}{Assignment\+Rule} and \hyperlink{class_kinetic_law}{Kinetic\+Law} objects in a model constitute a set of assignment statements that should be considered as a whole. (A \hyperlink{class_kinetic_law}{Kinetic\+Law} object is counted as an assignment because it assigns a value to the symbol contained in the \char`\"{}id\char`\"{} attribute of the \hyperlink{class_reaction}{Reaction} object in which it is defined.) This combined set of assignment statements must not contain algebraic loops---dependency chains between these statements must terminate. To put this more formally, consider a directed graph in which nodes are assignment statements and directed arcs exist for each occurrence of an S\+B\+ML species, compartment or parameter symbol in an assignment statement\textquotesingle{}s \char`\"{}math\char`\"{} subelement. Let the directed arcs point from the statement assigning the symbol to the statements that contain the symbol in their \char`\"{}math\char`\"{} subelement expressions. This graph must be acyclic.

Similarly, the combined set of \hyperlink{class_rate_rule}{Rate\+Rule} and \hyperlink{class_reaction}{Reaction} objects constitute a set of definitions for the rates of change of various model entities (namely, the objects identified by the values of the \textquotesingle{}variable\textquotesingle{} attributes of the \hyperlink{class_rate_rule}{Rate\+Rule} objects, and the \textquotesingle{}species\textquotesingle{} attributes of the \hyperlink{class_species_reference}{Species\+Reference} objects in each \hyperlink{class_reaction}{Reaction}). In S\+B\+ML Level~3 Version~2, these rates of change may be referenced directly using the {\itshape rate\+Of} csymbol, but may not thereby contain algebraic loops---dependency chains between these statements must terminate. More formally, consider a directed graph in which the nodes are the definitions of different variables\textquotesingle{} rates of change, and directed arcs exist for each occurrence of a variable referenced by a {\itshape rate\+Of} csymbol from any \hyperlink{class_rate_rule}{Rate\+Rule} or \hyperlink{class_kinetic_law}{Kinetic\+Law} object in the model. Let the directed arcs point from the variable referenced by the {\itshape rate\+Of} csymbol (call it {\itshape x}) to the variable(s) determined by the \textquotesingle{}math\textquotesingle{} expression in which {\itshape x} appears. This graph must be acyclic.

S\+B\+ML does not specify when or how often rules should be evaluated. Eliminating algebraic loops ensures that assignment statements can be evaluated any number of times without the result of those evaluations changing. As an example, consider the set of equations {\itshape x = x + 1}, {\itshape y = z + 200} and {\itshape z = y + 100}. If this set of equations were interpreted as a set of assignment statements, it would be invalid because the rule for {\itshape x} refers to {\itshape x} (exhibiting one type of loop), and the rule for {\itshape y} refers to {\itshape z} while the rule for {\itshape z} refers back to {\itshape y} (exhibiting another type of loop). Conversely, the following set of equations would constitute a valid set of assignment statements\+: {\itshape x = 10}, {\itshape y = z + 200}, and {\itshape z = x
\begin{DoxyItemize}
\item 100.
\end{DoxyItemize}}

{\itshape }\hypertarget{classdoc__rules__general__summary_rules-not-overdetermined}{}\subsubsection{A model must not be overdetermined}\label{classdoc__rules__general__summary_rules-not-overdetermined}
{\itshape  An S\+B\+ML model must not be overdetermined; that is, a model must not define more equations than there are unknowns in a model. A valid S\+B\+ML model that does not contain \hyperlink{class_algebraic_rule}{Algebraic\+Rule} structures cannot be overdetermined.}

{\itshape  Lib\+S\+B\+ML implements the static analysis procedure described in Appendix~B of the S\+B\+ML Level~3 specification for assessing whether a model is overdetermined.}

{\itshape  (In summary, assessing whether a given continuous, deterministic, mathematical model is overdetermined does not require dynamic analysis; it can be done by analyzing the system of equations created from the model. One approach is to construct a bipartite graph in which one set of vertices represents the variables and the other the set of vertices represents the equations. Place edges between vertices such that variables in the system are linked to the equations that determine them. For algebraic equations, there will be edges between the equation and each variable occurring in the equation. For ordinary differential equations (such as those defined by rate rules or implied by the reaction rate definitions), there will be a single edge between the equation and the variable determined by that differential equation. A mathematical model is overdetermined if the maximal matchings of the bipartite graph contain disconnected vertexes representing equations. If one maximal matching has this property, then all the maximal matchings will have this property; i.\+e., it is only necessary to find one maximal matching.)}

{\itshape }\hypertarget{classdoc__rules__general__summary_RuleType_t}{}\subsection{Rule types for S\+B\+M\+L Level 1}\label{classdoc__rules__general__summary_RuleType_t}
{\itshape  S\+B\+ML Level 1 uses a different scheme than S\+B\+ML Level 2 and Level 3 for distinguishing rules; specifically, it uses an attribute whose value is drawn from an enumeration of 3 values. Lib\+S\+B\+ML supports this using methods that work with the enumeration values listed below.}

{\itshape  \begin{DoxyItemize}
\item \{R\+U\+L\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+R\+A\+TE, Rule\+Type\+\_\+t\}\+: Indicates the rule is a \char`\"{}rate\char`\"{} rule. \item \{R\+U\+L\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+S\+C\+A\+L\+AR, Rule\+Type\+\_\+t\}\+: Indicates the rule is a \char`\"{}scalar\char`\"{} rule. \item \{R\+U\+L\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+I\+N\+V\+A\+L\+ID, Rule\+Type\+\_\+t\}\+: Indicates the rule type is unknown or not yet set. \end{DoxyItemize}
}

The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
\hyperlink{_assignment_rule_8h}{Assignment\+Rule.\+h}\end{DoxyCompactItemize}
